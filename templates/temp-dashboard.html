<!doctype html>
<html>
    <head>
        <script src="../static/lib/reqwest.min.js" type="text/javascript"> </script>
        <script src="../static/js/wallace.js" type="text/javascript"> </script>
        <script src="../static/lib/easeljs-0.7.0.min.js"></script>
        <script src="../static/lib/jquery-2.2.1.min.js"></script>
        <script src="../static/lib/Chart.js"></script>
        <script src="../static/lib/Chart.Scatter.js"></script>


<!--        <script src="../static/js/dashboard.js"></script>  COPY HEAD -->

        <!-- <script type="text/javascript">
            var hit_id = "{{ hit_id }}";
            var worker_id = "{{ worker_id }}";
            var assignment_id = "{{ assignment_id }}";
            var mode = "{{ mode }}";
            var uniqueId = worker_id.concat(":").concat(assignment_id); -->

        </script>
        <link rel="stylesheet" type="text/css" href="../static/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="../static/css/wallace.css">

    </head>

    <body>
        <h1>Line Segmentation Game Dashboard</h1>
        <h2>Chain content (experiment)</h1>
        <canvas id="myChartExperiment" width="700" height="200"></canvas><a href=""></a><a href=""></a>

        <h2>Chain content (practice)</h1>
        <canvas id="myChartPractice" width="700" height="200"></canvas><a href=""></a><a href=""></a>


        <h2>Chain length sucess/failure</h1>

        <canvas id="myChart" width="700" height="200"></canvas><a href=""></a>

        <h2>Raw data</h2>
         <p id="here_table"></p>

          <h2>Raw data as string</h2>
         <p id="RawData"> No data </p>
        <!-- <canvas id="demoCanvas" width="700" height="300">
        </canvas>-->
        <p id="Debug"> </p><a href=""></a>


        <script>

         mjson={"all_bonus": 0.0, "all_chain_lengths": "[1, 1, 1, 0, 0, 0, 2, 2]","all_chain_lengths_failed": "[1, 1, 1, 0, 0, 0, 1, 1]", "num_failed_nodes": 0, "min_chain_length": 0, "all_chain_length": 3, "max_chain_length": 1, "selected_part_bonus": 0.0, "summary_node_list": [{"is_fail": false, "source": 90, "net_role": "practice", "net_id": 1, "target": 85}, {"is_fail": false, "source": 2, "net_role": "practice", "net_id": 3, "target": 10}], "selected_part_num": 5};

        cjson= {"1": {"current": true, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "role": "practice", "y": [49, 52, 47, 46, 42, 47, 48, 44, 39, 41, 46, 46, 43, 37, 38, 42, 40, 49, 42], "label": "1|0.325488153031:0.851198014631"}, "2": {"current": true, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, -1], "role": "practice", "y": [79, 78, 79, 81, 77, 81, 82, 84, 82, 77, 80, 78, 78, 78, 85, 80, 81, 82, -1], "label": "2|0.325488153031:0.851198014631"}, "3": {"current": true, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, -1, -1, -1], "role": "practice", "y": [98, 92, 95, 100, 100, 100, 100, 100, 100, 100, 97, 99, 96, 96, 92, 94, -1, -1, -1], "label": "3|0.325488153031:0.851198014631"}, "4": {"current": true, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "role": "practice", "y": [96, 100, 99, 100, 96, 100, 97, 93, 91, 89, 94, 91, 97, 97, 92, 86, 83, 86, 85], "label": "4|0.325488153031:0.851198014631"}, "5": {"current": true, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, -1], "role": "practice", "y": [38, 36, 36, 38, 39, 37, 42, 39, 38, 43, 39, 38, 45, 50, 45, 39, 35, 42, -1], "label": "5|0.325488153031:0.851198014631"}, "6": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [60, 57, 62, 54, 61, 60, 59, 55, 47, 50, 53], "label": 6}, "7": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [84, 78, 74, 77, 82, 85, 91, 92, 90, 93, 85], "label": 7}, "8": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [56, 55, 56, 56, 47, 45, 45, 43, 40, 38, 35], "label": 8}, "9": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [15, 7, 5, 10, 19, 25, 20, 28, 31, 23, 17], "label": 9}, "10": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [37, 44, 44, 41, 45, 47, 48, 45, 47, 50, 45], "label": 10}, "11": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [11, 12, 9, 10, 10, 18, 13, 8, 10, 14, 10], "label": 11}, "12": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [32, 36, 37, 41, 35, 41, 48, 48, 49, 50, 57], "label": 12}, "13": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [56, 54, 52, 49, 40, 45, 42, 46, 39, 35, 32], "label": 13}, "14": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [46, 45, 45, 44, 45, 48, 49, 56, 50, 49, 52], "label": 14}, "15": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [40, 40, 42, 43, 46, 50, 48, 39, 48, 53, 48], "label": 15}, "16": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [73, 76, 77, 72, 79, 84, 84, 83, 81, 83, 83], "label": 16}, "17": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [98, 96, 99, 93, 100, 100, 100, 100, 100, 100, 100], "label": 17}, "18": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [34, 39, 45, 51, 50, 44, 44, 47, 49, 45, 44], "label": 18}, "19": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [99, 99, 96, 100, 95, 97, 100, 93, 99, 100, 99], "label": 19}, "20": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [22, 20, 14, 12, 14, 8, 11, 15, 16, 20, 27], "label": 20}, "21": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [5, 14, 17, 14, 14, 11, 13, 18, 20, 17, 17], "label": 21}, "22": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [94, 89, 90, 84, 84, 83, 83, 89, 89, 92, 94], "label": 22}, "23": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [98, 97, 100, 96, 96, 87, 84, 88, 85, 86, 78], "label": 23}, "24": {"current": true, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [80, 88, 88, 90, 94, 94, 93, 96, 99, 90, 91], "label": "24|0.325488153031:0.851198014631"}, "25": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [13, 11, 15, 16, 21, 20, 13, 15, 20, 11, 7], "label": 25}, "26": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [88, 93, 94, 100, 99, 94, 100, 98, 100, 100, 99], "label": 26}, "27": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [21, 24, 26, 18, 23, 27, 34, 36, 34, 40, 46], "label": 27}, "28": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [94, 95, 95, 87, 88, 86, 86, 85, 84, 90, 82], "label": 28}, "29": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [42, 45, 49, 50, 51, 54, 63, 59, 57, 65, 70], "label": 29}, "30": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [57, 65, 59, 63, 63, 64, 65, 64, 66, 63, 64], "label": 30}, "31": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [40, 40, 39, 35, 39, 45, 43, 42, 39, 41, 47], "label": 31}, "32": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [42, 35, 28, 25, 22, 22, 25, 33, 33, 30, 31], "label": 32}, "33": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [11, 17, 24, 24, 32, 28, 26, 17, 25, 29, 20], "label": 33}, "34": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [100, 100, 100, 96, 94, 100, 100, 99, 100, 97, 90], "label": 34}, "35": {"current": false, "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "role": "experiment", "y": [2, 3, 0, 6, 13, 12, 13, 13, 17, 26, 25], "label": 35}};

        fjson={"0.193525680575:0.818876214143": {"current": true, "x": [8, 12], "role": ["e", "p"], "y": [29, 92], "label": "0.193525680575:0.818876214143"}, "0.757456867661:0.804652704543": {"current": false, "x": [7, 2], "role": ["e", "e"], "y": [41, 90], "label": "0.757456867661:0.804652704543"}, "0.605577716405:0.169251538889": {"current": false, "x": [], "role": [], "y": [], "label": "0.605577716405:0.169251538889"}, "0.855047716253:0.451680954477": {"current": false, "x": [2, 1], "role": ["e", "e"], "y": [38, 29], "label": "0.855047716253:0.451680954477"}, "0.474089034284:0.193113104068": {"current": false, "x": [6, 4], "role": ["e", "e"], "y": [50, 38], "label": "0.474089034284:0.193113104068"}, "0.702487680791:0.144529053466": {"current": false, "x": [6, 5, 3, 6, 10, 9], "role": ["e", "e", "e", "e", "p", "p"], "y": [35, 86, 29, 30, 49, 81], "label": "0.702487680791:0.144529053466"}, "0.197790624714:0.85400510189": {"current": false, "x": [9, 14, 8, 13, 7, 5], "role": ["e", "p", "e", "p", "e", "e"], "y": [35, 86, 49, 49, 26, 90], "label": "0.197790624714:0.85400510189"}, "0.852713003031:0.467175238867": {"current": false, "x": [1, 1], "role": ["e", "e"], "y": [63, 23], "label": "0.852713003031:0.467175238867"}, "0.506167119165:0.144711870955": {"current": false, "x": [4, 6, 9, 8, 3], "role": ["e", "e", "p", "p", "e"], "y": [50, 50, 81, 92, 90], "label": "0.506167119165:0.144711870955"}, "0.951081085814:0.619706026034": {"current": false, "x": [2, 3, 3, 3, 4, 1], "role": ["e", "e", "e", "e", "p", "e"], "y": [35, 50, 100, 65, 81, 26], "label": "0.951081085814:0.619706026034"}, "0.444574196567:0.0227211670139": {"current": false, "x": [2, 2, 6, 8], "role": ["e", "e", "e", "p"], "y": [53, 23, 83, 49], "label": "0.444574196567:0.0227211670139"}, "0.725285365804:0.544540972294": {}, "0.325488153031:0.851198014631": {}, "0.233705017152:0.16718434838": {"current": false, "x": [9], "role": ["e"], "y": [100], "label": "0.233705017152:0.16718434838"}, "0.372761084372:0.96267271659": {"current": false, "x": [17], "role": ["p"], "y": [86], "label": "0.372761084372:0.96267271659"}, "0.141376999089:0.878399381068": {"current": false, "x": [1, 2], "role": ["e", "p"], "y": [23, 86], "label": "0.141376999089:0.878399381068"}, "0.182999639838:0.630163697274": {"current": false, "x": [9, 8], "role": ["e", "e"], "y": [50, 49], "label": "0.182999639838:0.630163697274"}, "0.955846468139:0.186539969279": {"current": false, "x": [2, 3, 4, 1, 2], "role": ["e", "e", "e", "e", "e"], "y": [11, 50, 93, 26, 90], "label": "0.955846468139:0.186539969279"}, "0.00099770681817:0.0772567146341": {"current": false, "x": [9], "role": ["e"], "y": [20], "label": "0.00099770681817:0.0772567146341"}, "0.321463196841:0.0472168179772": {"current": false, "x": [2, 4, 4, 6], "role": ["e", "e", "p", "p"], "y": [11, 100, 35, 81], "label": "0.321463196841:0.0472168179772"}, "0.178735177903:0.98105958937": {"current": false, "x": [2, 3, 2, 5, 3], "role": ["e", "e", "e", "e", "p"], "y": [50, 35, 11, 63, 92], "label": "0.178735177903:0.98105958937"}};






        document.getElementById("RawData").innerHTML=JSON.stringify(mjson);
        mjson_keys=Object.keys(mjson).sort();



        var content = "<table>"
        for(j in mjson_keys){
            var key=mjson_keys[j];
            var val=mjson[key]
            content += '<tr><td>' + 'result ' +  key + ': ' + val + '</td></tr>';
        }
        content += "</table>"

        $('#here_table').append(content);

        var ctx = document.getElementById("myChart").getContext("2d");
        var ctxPractice = document.getElementById("myChartPractice").getContext("2d");
        var ctxExperiment = document.getElementById("myChartExperiment").getContext("2d");


        var clist=JSON.parse(mjson.all_chain_lengths);
        var clistFail=JSON.parse(mjson.all_chain_lengths_failed);


        mlabels=[];
        for (j in clist) {
            mlabels[j]=String(j);
        }



        console.log(clist)
        var data = {
        labels: mlabels,
        datasets: [
            {
                label: "Sucess",
                fillColor: "rgba(0,220,0,0.5)",
                strokeColor: "rgba(20,220,0,0.8)",
                highlightFill: "rgba(0,220,0,0.75)",
                highlightStroke: "rgba(0,220,0,1)",
                data: clist
            },
            {
                label: "Fail",
                fillColor: "rgba(220,0,0,0.5)",
                strokeColor: "rgba(220,0,0,0.8)",
                highlightFill: "rgba(220,0,0,0.75)",
                highlightStroke: "rgba(220,0,0,1)",
                data: clistFail
            },
          ]
        };
        options = {
            //Boolean - Whether the scale should start at zero, or an order of magnitude down from the lowest value
            scaleBeginAtZero : true,

            //Boolean - Whether grid lines are shown across the chart
            scaleShowGridLines : true,

            //String - Colour of the grid lines
            scaleGridLineColor : "rgba(0,0,0,.05)",

            //Number - Width of the grid lines
            scaleGridLineWidth : 1,

            //Boolean - Whether to show horizontal lines (except X axis)
            scaleShowHorizontalLines: true,

            //Boolean - Whether to show vertical lines (except Y axis)
            scaleShowVerticalLines: true,

            //Boolean - If there is a stroke on each bar
            barShowStroke : true,

            //Number - Pixel width of the bar stroke
            barStrokeWidth : 2,

            //Number - Spacing between each of the X value sets
            barValueSpacing : 5,

            //Number - Spacing between data sets within X values
            barDatasetSpacing : 1,

            //String - A legend template
            legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].fillColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>"

        }
        var myBarChart = new Chart(ctx).Bar(data, options);
        var data2 = [];
        var data3 = [];
        for (c in cjson) {
            var val = cjson[c];
            var mcurrent=Boolean(val.current);
            var mx=val.x;
            var my=val.y;

            var mlabel=val.label;
            var mrole=val.role;
            var mdata=[]
            var clr=''


                if (mcurrent) {
                    clr = '0,0,120';
                } else {

                    clr = '120,120,120';
                }

            for (i=0;i<mx.length;i++) {
                 var x=mx[i];
                 var y=my[i];
                 var r=1;

                  if (mcurrent) {
                    r=2
                  }

                 if (x>=0) {
                     x = x + Math.random()*0.2 + 0.2;
                     mdata.push({'x': x, 'y': y, 'r': r})
                 }

            }
            if (mrole=="experiment") {

                data2.push ({
                    label: mlabel,
                    strokeColor: 'rgba('+ clr +',0.3)',
                    pointColor: 'rgba(' + clr + ',0.5)',
                    pointStrokeColor: 'rgba(' + clr + ',0)',
                    data: mdata
                });}
                else {
                    data3.push ({
                    label: mlabel,
                    strokeColor: 'rgba('+ clr +',0.3)',
                    pointColor: 'rgba(' + clr + ',0.5)',
                    pointStrokeColor: 'rgba(' + clr + ',0)',
                    data: mdata
                });}

        }

        for (c in fjson) {
            var val = fjson[c];
            var mcurrent=Boolean(val.current);
            var mx=val.x;
            var my=val.y;
            if (mx == null) {continue}
             //console.log(mx.length)
            // console.log(typeof mx)
            // console.log(mx[1])


            var mlabel=val.label;
            var mrole=val.role;
            var mdata_e=[]
            var mdata_p=[]

            var clr=''
            console.log(mcurrent)
            if (mcurrent) {
                clr = '250,0,250';
            } else {

                clr = '250,0,0';
            }

            for (i=0;i<mx.length;i++) {
                 var x=mx[i];
                 var y=my[i];
                 var rle=mrole[i];
                 if (mcurrent) {
                    r=2
                 } else {
                    r=1
                 }

                 if (x>=0) {
                     x = x + Math.random()*0.2 + 0.0;
                     if (rle=="e"){
                         mdata_e.push({'x': x, 'y': y, 'r': r})
                     } else {
                         mdata_p.push({'x': x, 'y': y, 'r': r})
                     }
                 }

            }

                data2.push ({
                    label: mlabel,
                    strokeColor: 'rgba('+ clr +',0)',
                    pointColor: 'rgba(' + clr + ',0.5)',
                    pointStrokeColor: 'rgba(' + clr + ',0)',
                    data: mdata_e
                });
                data3.push ({
                    label: mlabel,
                    strokeColor: 'rgba('+ clr +',0)',
                    pointColor: 'rgba(' + clr + ',0.5)',
                    pointStrokeColor: 'rgba(' + clr + ',0)',
                    data: mdata_p
                });
        }

        //////////////////////
          //       var data2 = [
          //   {
          //     label: 'Chain 1',
          //     strokeColor: 'rgba(220,0,0,0.1)',
          //     pointColor: 'rgba(220,0,0,1)',
          //     pointStrokeColor: 'rgba(220,0,0,0.8)',
          //     data: [
          //       { x: 1, y: 65 },
          //       { x: 2, y: 59 },
          //       { x: 3, y: 69 },
          //       { x: 4, y: 81 },
          //       { x: 5, y: 56 }
          //     ]
          //   },

          // ];

          var options2= {
                          // Boolean - If we should show the scale at all
                showScale: true,

                // String - Colour of the scale line
                scaleLineColor: "rgba(0,0,0,.1)",

                // Number - Pixel width of the scale line
                scaleLineWidth: 1,

                // Boolean - Whether to show labels on the scale
                scaleShowLabels: true,

                // Interpolated JS string - can access value
                scaleLabel: "<%=value%>",

                // Interpolated JS string - can access value
                scaleArgLabel: "<%=value%>",

                // String - Message for empty data
                emptyDataMessage: "chart has no data",

                // GRID LINES

                // Boolean - Whether grid lines are shown across the chart
                scaleShowGridLines: true,

                // Number - Width of the grid lines
                scaleGridLineWidth: 1,

                // String - Colour of the grid lines
                scaleGridLineColor: "rgba(0,0,0,.05)",

                // Boolean - Whether to show horizontal lines (except X axis)
                scaleShowHorizontalLines: true,

                // Boolean - Whether to show vertical lines (except Y axis)
                scaleShowVerticalLines: true,

                // HORIZONTAL SCALE RANGE

                // Boolean - If we want to override with a hard coded x scale
                xScaleOverride: false,

                // VERTICAL SCALE RANGE

                // Boolean - If we want to override with a hard coded y scale
                scaleOverride: false,
                // DATE SCALE

                // String - scale type: "number" or "date"
                scaleType: "number",


                // LINES

                // Boolean - Whether to show a stroke for datasets
                datasetStroke: true,

                // Number - Pixel width of dataset stroke
                datasetStrokeWidth: 2,

                // String - Color of dataset stroke
                datasetStrokeColor: '#007ACC',

                // String - Color of dataset stroke
                datasetPointStrokeColor: 'white',

                // Boolean - Whether the line is curved between points
                bezierCurve: false,

                // Number - Tension of the bezier curve between points
                //                bezierCurveTension: 0.4,

                // POINTS

                // Boolean - Whether to show a dot for each point
                pointDot: true,

                // Number - Pixel width of point dot stroke
                pointDotStrokeWidth: 1,

                // Number - Radius of each point dot in pixels
                pointDotRadius: 3,

                // Number - amount extra to add to the radius to cater for hit detection outside the drawn point
                pointHitDetectionRadius: 4,
          };

           var myChart2= new Chart(ctxPractice).Scatter(data3, options2);
           var myChart3= new Chart(ctxExperiment).Scatter(data2, options2);

        ///////////




        </script>
    </body>
</html>
